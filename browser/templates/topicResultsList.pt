<ul tal:define="view options/view;
  onlyGroup options/onlyGroup;
  munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date;
  topics view/get_results"
  class="searchResults">
  <tal:block tal:repeat="topic topics">
    <li id="abc123" tal:attributes="id topic/topic_id">
      <a class="topic" href="#"
        tal:attributes="href string:/r/topic/${topic/last_post_id}"
        tal:content="topic/subject"/>
      <!--Files go here-->
      <span class="files" tal:condition="topic/files">
        <tal:block tal:repeat="file topic/files">
          <a href="#" title="foo"
            tal:attributes="title file/name;
              href file/url;
              class string:fileIcon ${file/icon}">&#160;</a>
        </tal:block>
      </span>
      <div class="groupInfo" tal:condition="not:onlyGroup">
        <a class="group" href="#" 
          tal:attributes="href topic/group/url;"
          tal:content="topic/group/name"/>
      </div>
      <div class="tags" tal:condition="topic/keywords">
        <ul>
          <tal:block tal:repeat="keyword topic/keywords">
            <li tal:content="keyword"/>
          </tal:block>
        </ul>
      </div><!--tags-->
      <div class="metadata"
        tal:define="multiplePosts python:topic['num_posts']&gt;1">
        <span class="postCount">
          <span class="cardinal" tal:content="topic/num_posts"/>
          post<tal:block condition="multiplePosts">s</tal:block> 
        </span>
        &#8212;
        <tal:block condition="multiplePosts">latest post</tal:block>
        by
        <a class="name" href="#" 
          tal:omit-tag="not:topic/last_author/exists"
          tal:attributes="href topic/last_author/url"
          tal:content="topic/last_author/name">Me!</a>
        at
        <span class="date"
          tal:define="ctx topic/context" 
          tal:content="python:munge_date(ctx, topic['last_post_date'])"/>
      </div><!--metadata-->
    </li>
  </tal:block>
</ul>

